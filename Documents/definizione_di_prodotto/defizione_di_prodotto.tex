% ATTENZIONE!!! 
% Per far funzionare i collegamenti ipertestuali si raccomanda di usare
%	\classname{nomedellaclasse}
% per le classi dello stesso package mentre invece 
%	\hyperref[nomedellaclasse]{\ttfamily{}nomequalificatodellaclasse}
% per le classi che non sono dello stesso package e che hanno il nome completo

% **************************************************
% Macro specifiche per il documento corrente
% **************************************************
% Nome
\newcommand{\docName}{Definizione di prodotto}
% Nome file
\newcommand{\docFileName}{definizione\_di\_prodotto.1.0.pdf}
% Versione
\newcommand{\docVers}{1.0}
% Data creazione
\newcommand{\creationDate}{2013-02-03}
% Data ultima modifica
\newcommand{\modificationDate}{2013-02-03}
% Stato in {Approvato, Non approvato}
\newcommand{\docState}{Non approvato}
% Uso in {Interno, Esterno}
\newcommand{\docUsage}{Esterno}
% Destinatari da specificare come nome1\\ &nome2\\ ecc.
\newcommand{\docDistributionList}{Prof. Tullio Vardanega\\&Prof. Riccardo Cardin\\&Dott. Gregorio Piccoli\\&Team SoftwareSynthesis}
% Redattori da specificare come nome1\\ &nome2\\ ecc.
\newcommand{\docAuthors}{Elena Zecchinato\\&Andrea Meneghinello\\&Riccardo Tresoldi}
% Approvato da
\newcommand{\approvedBy}{Andrea Rizzi}
% Verificatori
\newcommand{\verifiedBy}{Stefano Farronato\\&Marco Schivo}
% Perscorso (relativo o assoluto) che punta alla directory contenente shared/
% come sua sottodirectory (per comodità chiamiamola 'doc root').
\newcommand{\docRoot}{..}
% definire se si vuole l'indice delle tabelle
\def\INDICETABELLE{false}
% definire se si vuole l'indice delle figure
\def\INDICEFIGURE{false}

% importa il preambolo condiviso da tutti i documenti
\input{\docRoot/shared/preamble.tex}

% macro specifiche per il documento corrente
\newcommand{\classsection}[1]{\subsubsection{#1}\label{#1}}
\newcommand{\classname}[1]{\hyperref[#1]{\ttfamily#1}}

% Fine del preambolo e inizio del documento
\begin{document}

% Inclusione della prima pagina
\input{\docRoot/shared/firstpage.tex}

%---------------------------RUOLI----------------------------
%FASE 1:
%Programmatori: DIEGO, STEFANO, SCHIVO
%FASE 2:
%Programmatori: MENE, TRES, ELENA

%Verificatore: SCHIVO, STEFANO, RIZZI, DIEGO (dobbiamo fare un sacco di test)
%Responsabile finale supremo: RIZZI
%------------------------------------------------------------

% Storico delle modifiche
\section*{Storia delle modifiche}
\begin{center}
\begin{longtable}{lp{.32\textwidth}lll}
\toprule
Versione & Descrizione intervento & Membro & Ruolo & Data\\
\midrule % inserire qui il contenuto della tabella
0.1 & Creazione del documento e stesura delle sezioni ``Introduzione'' e ``Riferimenti''. & &  & 2013-02-03\\
\bottomrule
\end{longtable}
\end{center}
\newpage

% inclusione dell'indice
\input{\docRoot/shared/toc.tex}

% Alcuni aggiustamenti per le pagine
\pagenumbering{arabic}
\setcounter{page}{1}
\pagestyle{normal}

% Qui ha inizio il documento vero e proprio...
\newpage

\section{Introduzione}
\subsection{Scopo del prodotto}
\purpose

\subsection{Scopo del documento}
Il presente documento presenta una descrizione dettagliata dell'architettura del sistema software destinata a costituire il prodotto \caName{}, coerentemente con la progettazione ad alto livello contenuta nell'allegato \textit{specifica\_tecnica.2.0.pdf}.

A tal fine, si riporta per ognuno dei componenti definiti nel documento di specifica tecnica una descrizione delle classi in termini di operazioni disponibili, proprietà, responsabilità e collaborazioni. Il contenuto del presente documento ha inoltre valore vincolante per i programmatori, che avranno l'obbligo di attenersi alle disposizioni in esso contenute senza alcuna possibilità di deroga.

\subsection{Glossario}
\glossaryIntro

\subsection{Convenzioni di scrittura}
% vedere issue #56 al riguardo
Al fine di rendere quanto più agevole possibile la consultazione di questo documento da parte dei programmatori e del committente, è stata adottata una serie di accorgimenti sia a livello di riferimenti sulla nomenclatura delle classi sia a livello cromatico per campi dati e metodi. 
Tali norme possono essere consultate in dettaglio nel documento \textit{norme\_di\_progetto.3.0.pdf} allegato.
\clearpage

\section{Riferimenti}
\subsection{Normativi}
\begin{itemize}
\item[] \textit{piano\_di\_qualifica.3.0.pdf} allegato.
\item[] \textit{norme\_di\_progetto.3.0.pdf} allegato.
\item[] \textit{specifica\_tecnica.2.0.pdf} allegato
\end{itemize}

\subsection{Informativi}
\begin{itemize}
\item[] Capitolato d'appalto: \caName{}, v1.0, redatto e rilasciato dal proponente Zucchetti s.r.l. reperibile all'indirizzo \url{http://www.math.unipd.it/~tullio/IS-1/2012/Progetto/C1.pdf};
\item[] testo di consultazione: \textit{Software Engineering (8th edition) Ian Sommerville, Pearson Education | Addison Wesley};
\item[] manuale all'utilizzo dei design pattens: \textit{Design Patterns, Elementi per il riuso di software a oggetti -- (1/Ed. italiana) Eric Gamma, Richard Helm, Ralph Johnson, John Vlissides, Pearson Education};
\item[] \textit{glossario.3.0.pdf} allegato.
\end{itemize}
\clearpage

\section{Standard di progetto}

\subsection{Standard di progettazione architetturale}
Lo sviluppo del progetto ha seguito le regole architetturali specificate nel documento  \textit{norme\_di\_progetto.3.0.pdf} allegato.

\subsection{Standard di documentazione del codice}
Le regole che definiscono la documentazione del codice relativo al funzionamento del prodotto sono specificate nel documento \textit{norme\_di\_progetto.3.0.pdf} allegato.

\subsection{Standard di denominazione di entità e relazioni}
Le convenzioni relative alla denominazione delle entità e le relative relazioni sono specificate nel documento \textit{norme\_di\_progetto.3.0.pdf} allegato.

\subsection{Standard di programmazione}
Le regole relative agli standard di programmazione sono enunciate nel documento \textit{norme\_di\_progetto.3.0.pdf} allegato.

\subsection{Strumenti di lavoro}
Gli strumenti utilizzati per la stesura e lo sviluppo sono specificati nei documenti \textit{norme\_di\_progetto.3.0.pdf} e \textit{piano\_di\_qualifica.3.0.pdf} allegati.

\clearpage

\section{Specifica sotto-architettura sever}\label{sec:serverarchitecture}

\subsection{Package org.softwaresynthesis.mytalk.server}\label{sec:server}

\classsection{HibernateUtil}

\subsubsection*{Funzione}
Interfaccia usata per dichiarare che l'oggetto che la implementa ha la possibilità di essere convertito in formato json in modo da poter essere trasferito al client.

\subsubsection*{Relazioni d'uso}

Nessuna relazione evidenziata.

\subsubsection*{Metodi}

\begin{description}
	\item{\method{+ toJson()}}\\
	Converte l'oggetto di invocazione in una stringa json interpretabile dai client.
\end{description}

\subsection{Package org.softwaresynthesis.mytalk.server.dao}\label{sec:dao}

\classsection{HibernateUtil}

\subsubsection*{Funzione}
Inizializza un'unica \inglese{factory} per le sessioni, utilizzate da Hibernate, per comunicare con il database.

\subsubsection*{Relazioni d'uso}

\begin{itemize}
	\item \classname{org.hibernate.SessionFactory}: necessaria per interrogare il database.
	\item \classname{org.hibernate.cfg.Configuration}: definisce i parametri necessari per la connessione con il database. Inoltre definisce i mapping necessari tra le classi \inglese{transfer object} e le relative tabelle nel database.
\end{itemize}

\subsubsection*{Attributi}

\begin{itemize}
	\item{\memberdata{-- \underline{instance}: HibernateUtil}}\\
	Attributo usato per implementare il \inglese{pattern} singleton. Tale istanza verrà inizializzata tramite il metodo statico \method{getIstance()}, che si assicura che l'attributo non sia già stato inizializzato in precedenza.
	\item{\memberdata{-- \underline{sessionFactory}: SessionFactory}}\\
	Attributo contenente la \inglese{factory} delle sessioni verso il database.
\end{itemize}

\subsubsection*{Metodi}

\begin{description}
	\item{\method{-- HibernateUtil()}}\\
	Costruttore privato della classe. Si osservi che il costruttore è stato definito \inglese{private} in correlazione all'applicazione del \inglese{pattern} singleton.
	\item{\method{+ getInstance(): HibernateUtil}}\\
	Metodo pubblico che ritorna l'istanza \memberdata{istance}. Il metodo controlla se \memberdata{istance} è già stata inizializzata. Nel caso non lo sia il metodo dovrà generare un istanza di HibernateUtil richiamando il costruttore privato \method{HibernateUtil()} assegnare il valore ritornato all'attributo \memberdata{istance}. Il programma termina restituendo \memberdata{istance}.
	\item{\method{+ getSessionFactory(): SessionFactory}}\\
	Metodo che ritorna l'attributo \memberdata{sessionFactory}.
\end{description}

\classsection{UserDataDAO}

\subsubsection*{Funzione}
Classe implementante il pattern DAO. Definisce le procedure d'inserimento, eliminazione ed aggiornamento di \inglese{entry} inerenti la tabella UserData. La classe fornisce anche metodi per interrogare il database ed ottenere i dati utente con i quali costruire istanze di oggetti di tipo \classname{abook.IUserData}.

\subsubsection*{Relazioni d'uso}

\begin{itemize}
	\item \texttt{java.util.List}: usata per memorizzare e ritornare i dati restituiti dalle interrogazioni a database.
	\item \classname{org.hibernate.Query}: classe rappresentante le query d'interrogazione verso il database
	\item \texttt{org.hibernate.Session}: classe che rappresenta la sessione di ``lavoro'' verso il database.
	\item \texttt{org.hibernate.SessionFactory}: classe avente compito d'istanziare nuove sessioni.
	\item \texttt{org.hibernate.Transaction}: classe che rappresenta una transazione del database.
	\item \classname{abook.IUserData}: interfaccia del package abook, usata per definire un generico utente. La classe può ritornare istanze di tipo \classname{abook.IUserData} come risposta a delle query d'interrogazione al database.
	
\end{itemize}

\subsubsection*{Attributi}

Nessun attributo evidenziato.

\subsubsection*{Metodi}

\begin{description}

	\item{\method{+ insert(user: IUserData): boolean}}\\
	Metodo usato per inserire un utente registrato nel sistema. Il metodo riceve come parametro un istanza di un oggetto \classname{abook.IUserData}. Il metodo dovrà eseguire nell'ordine le seguenti operazioni:
		\begin{itemize}
			\item[1)] ottenere dalla classe \classname{HibernateUtil} l'istanza tramite il metodo statico \method{getIstance()};
			\item[2)] ottenere dall'istanza di tipo \classname{HibernateUtil}(ottenuta al punto precedente), un oggetto di tipo \texttt{org.hibernate.SessionFactory}, tramite il metodo \method{getSessionFactory()};
			\item[3)] aprire la sessione ottenuta al punto precedente;
			\item[4)] avviare una transizione a partire dall'istanza \texttt{org.hibernate.SessionFactory} del punto 2. Tale istanza va memorizzato in un opportuno attributo (interno al metodo stesso) di tipo \texttt{org.hibernate.Transaction};
			\item[5)] eseguire il comando \inglese{save} a partire dalla sessione aperta e passando come parametro l'attributo \memberdata{user}.
			\item[6)] eseguire il comando \inglese{commit} per confermare l'operazione del punto precedente.
		\end{itemize}
		
Poiché l'iter presentato può scatenare il lancio di eccezione, il codice dovrà essere gestito in un blocco \inglese{try-catch}. Nel caso incorra il lancio di un eccezione, il flusso di processo dovrà ristabilire la situazione iniziale richiamando il metodo \texttt{rollback()} dell'istanza di tipo \texttt{org.hibernate.Transaction} creata al punto 4 dell'iter. In ogni caso il metodo deve terminare chiudendo la sessione aperta al punto 2.

	\item{\method{+ delete(user: IUserData): boolean}}\\
	Metodo usato per eliminare un utente registrato nel sistema. Il metodo riceve come parametro un istanza di un oggetto \classname{abook.IUserData}. Il metodo dovrà eseguire nell'ordine le seguenti operazioni:
		\begin{itemize}
			\item[1)] ottenere dalla classe \classname{HibernateUtil} l'istanza tramite il metodo statico \method{getIstance()};
			\item[2)] ottenere dall'istanza di tipo \classname{HibernateUtil}(ottenuta al punto precedente), un oggetto di tipo \texttt{org.hibernate.SessionFactory}, tramite il metodo \method{getSessionFactory()};
			\item[3)] aprire la sessione ottenuta al punto precedente;
			\item[4)] avviare una transizione a partire dall'istanza \texttt{org.hibernate.SessionFactory} del punto 2. Tale istanza va memorizzato in un opportuno attributo (interno al metodo stesso) di tipo \texttt{org.hibernate.Transaction};
			\item[5)] eseguire il comando \inglese{delete} a partire dalla sessione aperta e passando come parametro l'attributo \memberdata{user}.
			\item[6)] eseguire il comando \inglese{commit} per confermare l'operazione del punto precedente.
		\end{itemize}
		
Poiché l'iter presentato può scatenare il lancio di eccezione, il codice dovrà essere gestito in un blocco \inglese{try-catch}. Nel caso incorra il lancio di un eccezione, il flusso di processo dovrà ristabilire la situazione iniziale richiamando il metodo \texttt{rollback()} dell'istanza di tipo \texttt{org.hibernate.Transaction} creata al punto 4 dell'iter. In ogni caso il metodo deve terminare chiudendo la sessione aperta al punto 2.

\item{\method{+ update(user: IUserData): boolean}}\\
	Metodo usato per modificare i dati di un utente registrato nel sistema. Il metodo riceve come parametro un istanza di un oggetto \classname{abook.IUserData}. Il metodo dovrà eseguire nell'ordine le seguenti operazioni:
		\begin{itemize}
			\item[1)] ottenere dalla classe \classname{HibernateUtil} l'istanza tramite il metodo statico \method{getIstance()};
			\item[2)] ottenere dall'istanza di tipo \classname{HibernateUtil}(ottenuta al punto precedente), un oggetto di tipo \texttt{org.hibernate.SessionFactory}, tramite il metodo \method{getSessionFactory()};
			\item[3)] aprire la sessione ottenuta al punto precedente;
			\item[4)] avviare una transizione a partire dall'istanza \texttt{org.hibernate.SessionFactory} del punto 2. Tale istanza va memorizzato in un opportuno attributo (interno al metodo stesso) di tipo \texttt{org.hibernate.Transaction};
			\item[5)] eseguire il comando \inglese{update} a partire dalla sessione aperta e passando come parametro l'attributo \memberdata{user}.
			\item[6)] eseguire il comando \inglese{commit} per confermare l'operazione del punto precedente.
		\end{itemize}
		
Poiché l'iter presentato può scatenare il lancio di eccezione, il codice dovrà essere gestito in un blocco \inglese{try-catch}. Nel caso incorra il lancio di un eccezione, il flusso di processo dovrà ristabilire la situazione iniziale richiamando il metodo \texttt{rollback()} dell'istanza di tipo \texttt{org.hibernate.Transaction} creata al punto 4 dell'iter. In ogni caso il metodo deve terminare chiudendo la sessione aperta al punto 2.

	\item{\method{+ getByNameAndSurname(name: String, surname: String): List<IUserData>}}\\
	Metodo usato per eseguire un interrogazione al database atta ad ottenere la lista degli utenti aventi un determinato nome e cognome. Il metodo riceve come parametro il nome e il cognome da ricercare. Il metodo dovrà eseguire nell'ordine le seguenti operazioni:
		\begin{itemize}
			\item[1)] ottenere dalla classe \classname{HibernateUtil} l'istanza tramite il metodo statico \method{getIstance()};
			\item[2)] ottenere dall'istanza di tipo \classname{HibernateUtil}(ottenuta al punto precedente), un oggetto di tipo \texttt{org.hibernate.SessionFactory}, tramite il metodo \method{getSessionFactory()};
			\item[3)] aprire la sessione ottenuta al punto precedente;
			\item[4)] eseguire il comando \inglese{createQuery()} a partire dall'istanza che definisce la sessione, passando come parametro una stringa rappresentante la \inglese{query} d'interrogazione al database (la \inglese{query} deve restituire dati validi e conformi alle aspettative presentate nell'introduzione di questo metodo). Una prima analisi evidenzia che una \inglese{query} corretta è: 
\begin{verbatim}
from UserData as u where u.name = :name or u.surname = :surname
\end{verbatim}
			\item[5)] eseguire una serie di comandi di tipo \texttt{setString} per ogni ``variabile'' presente nella \inglese{query} d'interrogazione (per variabile si intende ogni valore di filtraggio presente nelle clausole \inglese{where} delle \inglese{query} HQL, segnato come \texttt{:nome\_variabile}).
			\item[6)] eseguire il comando \inglese{commit} per eseguire l'interrogazione a database ed ottenere la lista di valori da ritornare.
		\end{itemize}
		
Il metodo deve terminare chiudendo la sessione aperta al punto 2.
	
	\item{\method{+ getByEmail(mail: String): IUserData}}\\
	Metodo usato per eseguire un interrogazione al database atta ad ottenere l'utente avente un determinato indirizzo e-mail. Il metodo riceve come parametro l'indirizzo e-mail da ricercare. Il metodo dovrà eseguire nell'ordine le seguenti operazioni:
		\begin{itemize}
			\item[1)] ottenere dalla classe \classname{HibernateUtil} l'istanza tramite il metodo statico \method{getIstance()};
			\item[2)] ottenere dall'istanza di tipo \classname{HibernateUtil}(ottenuta al punto precedente), un oggetto di tipo \texttt{org.hibernate.SessionFactory}, tramite il metodo \method{getSessionFactory()};
			\item[3)] aprire la sessione ottenuta al punto precedente;
			\item[4)] eseguire il comando \inglese{createQuery()} a partire dall'istanza che definisce la sessione, passando come parametro una stringa rappresentante la \inglese{query} d'interrogazione al database (la \inglese{query} deve restituire dati validi e conformi alle aspettative presentate nell'introduzione di questo metodo). Una prima analisi evidenzia che una \inglese{query} corretta è: 
\begin{verbatim}
from UserData as u where u.mail = :mail
\end{verbatim}
			\item[5)] eseguire una serie di comandi di tipo \texttt{setString} per ogni ``variabile'' presente nella \inglese{query} d'interrogazione (per variabile si intende ogni valore di filtraggio presente nelle clausole \inglese{where} delle \inglese{query} HQL, segnato come \texttt{:nome\_variabile}).
			\item[6)] eseguire il comando \inglese{commit} per eseguire l'interrogazione a database ed ottenere la lista di valori da ritornare.
		\end{itemize}
		
Il metodo deve terminare chiudendo la sessione aperta al punto 2.	
	
	
	\item{\method{+ searchGeneric(value: String): List<IUserData>}}\\
		Metodo usato per eseguire un interrogazione generica al database atta ad ottenere una lista di utenti aventi: o un determinato indirizzo e-mail, o un determinato nome o un determinato cognome. Il metodo riceve come parametro la stringa da ricercare. Il metodo dovrà eseguire nell'ordine le seguenti operazioni:
		\begin{itemize}
			\item[1)] ottenere dalla classe \classname{HibernateUtil} l'istanza tramite il metodo statico \method{getIstance()};
			\item[2)] ottenere dall'istanza di tipo \classname{HibernateUtil}(ottenuta al punto precedente), un oggetto di tipo \texttt{org.hibernate.SessionFactory}, tramite il metodo \method{getSessionFactory()};
			\item[3)] aprire la sessione ottenuta al punto precedente;
			\item[4)] eseguire il comando \inglese{createQuery()} a partire dall'istanza che definisce la sessione, passando come parametro una stringa rappresentante la \inglese{query} d'interrogazione al database (la \inglese{query} deve restituire dati validi e conformi alle aspettative presentate nell'introduzione di questo metodo). Una prima analisi evidenzia che una \inglese{query} corretta è: 
\begin{verbatim}
from UserData as u where u.mail like :mail or u.name like :name or
\end{verbatim}
\begin{verbatim}
u.surname like :surname
\end{verbatim}
			\item[5)] eseguire una serie di comandi di tipo \texttt{setString} per ogni ``variabile'' presente nella \inglese{query} d'interrogazione (per variabile si intende ogni valore di filtraggio presente nelle clausole \inglese{where} delle \inglese{query} HQL, segnato come \texttt{:nome\_variabile}).
			\item[6)] eseguire il comando \inglese{commit} per eseguire l'interrogazione a database ed ottenere la lista di valori da ritornare.
		\end{itemize}
		
Il metodo deve terminare chiudendo la sessione aperta al punto 2.

\end{description}

\subsection{Package org.softwaresynthesis.mytalk.server.abook}\label{sec:abook}

\classsection{IUserData}

\subsubsection*{Funzione}
Interfaccia rappresentante il comportamento di un generico utente del sistema. L'interfaccia dovrà definire dei metodi di tipo get e set per i dati d'interesse.

\subsubsection*{Relazioni d'uso}

\begin{itemize}
	\item \texttt{org.softwaresynthesis.mytalk.server.IMyTalkObject}: interfaccia da estendere. Ogni oggetto che implementerà l'interfaccia \classname{IUserData} dovrà essere in grado di convertire il proprio contenuto informativo in formato Json.
	\item \classname{AddressBookEntry}: l'interfacci definisce dei metodi per la manipolazione di dati \classname{AddressBookEntry}.
\end{itemize}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ getId(): Long}}\\
	Restituisce l'identificatore univoco di uno \classname{IUserData}.
	\item{\method{+ getEmail(): String}}\\
	Restituisce l'indirizzo e-mail con cui uno \classname{IUserData} si è registrato nel sistema mytalk.
	\item{\method{+ setEmail(mail: String): void}}\\ 
	Imposta l'indirizzo e-mail con cui si registra nel sistema mytalk uno \classname{IUserData}.
	\item{\method{+ getPassword(): String}}\\
	Restituisce la password di accesso al sistema mytalk di uno \classname{IUserData}.
	\item{\method{+ setPassword(password: String): void}}\\
	Imposta la password di accesso al sistema di uno \classname{IUserData}.
	\item{\method{+ getQuestion(): String}}\\
	Restituisce la domanda segreta, scelta da uno \classname{IUserData}, per il recupero della password smarrita di accesso al sistema mytalk.
	\item{\method{+ setQuestion(question: String): void}}\\
	Imposta la domanda segreta, scelta da uno \classname{IUserData}, per il recupero della password smarrita di accesso al sistema mytalk.
	\item{\method{+ getAnswer(): String}}\\
	Restituisce la risposta alla domanda per il recupero della password smarrita di accesso al sistema mytalk.
	\item{\method{+ setAnswer(answer: String): void}}\\
	Imposta la risposta alla domanda segreta per il recupero della password di accesso al sistema mytalk.
	\item{\method{+ getName(): String}}\\
	Restituisce il nome di uno \classname{IUserData}.
	\item{\method{+ setName(name: String): void}}\\
	Imposta il nome di uno \classname{IUserData}.
	\item{\method{+ getSurname(): String}}\\
	Resituisce il cognome di uno \classname{IUserData}.
	\item{\method{+ setSurname(surname: String): void}}\\
	Imposta il cognome di uno \classname{IUserData}.
	\item{\method{+ getPicturePath(): String}}\\
	Restituisce una stringa con il percorso dell'immagine del profilo di uno \classname{IUserData}.
	\item{\method{+ setPicturePath(path: String): void}}\\
	Imposta il percorso dell'immagine profilo di uno \classname{IUserData}.
	\item{\method{+ getAddressBook(): Set<AddressBookEntry>}}\\
	Metodo che ritorna il la rubrica dell'utente sotto forma d'insieme di \classname{AddressBookEntry}.
	\item{\method{+ addAddressBookEntry(entry: AddressBookEntry): void}}\\
	Metodo usato per aggiungere una nuova \classname{AddressBookEntry} all'insieme di entry che costituisce la rubrica utente.
\end{description}

\classsection{IGroup}

\subsubsection*{Funzione}
Interfaccia rappresentante un gruppo di una rubrica utente del sistema mytalk

\subsubsection*{Relazioni d'uso}

\begin{itemize}
		\item \texttt{org.softwaresynthesis.mytalk.server.IMyTalkObject}: interfaccia da estendere. Ogni oggetto che implementerà l'interfaccia \classname{IGroup} dovrà essere in grado di convertire il proprio contenuto informativo in formato Json.
\end{itemize}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ getId(): Long}}\\
	Restituisce l'identificativo univoco di uno gruppo di una rubrica utente.
	\item{\method{+ getName(): String}}\\
	Restituisce il nome di un gruppo di una rubrica utente.
	\item{\method{+ setName(name: String): void}}\\
	Imposta il nome di un gruppo di una rubrica utente.
\end{description}

\classsection{IAddressBookEntry}

\subsubsection*{Funzione}
Interfaccia rappresentante una entry di una rubrica utente del sistema mytalk

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{org.softwaresynthesis.mytalk.server.IMyTalkObject}: interfaccia da estendere. Ogni oggetto che implementerà l'interfaccia \classname{IAddressBookEntry} dovrà essere in grado di convertire il proprio contenuto informativo in formato Json.
	\item \classname{IUserData}: l'interfaccia \classname{IAddressBookEntry} definisce più metodi che restituiscono oggetti aventi tipo di ritorno \classname{IUserData}. Tali sono i metodi \inglese{get} per ottenere il ``possessore'' della rubrica e per ottenere l'utente registrato nella rubrica. Analogamente \classname{IUserData} viene usato come parametro d'ingresso per i metodi \inglese{set} collegati ai metodi già citati.
\end{itemize}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ getId(): Long}}\\
	Resituisce l'identificativo univoco di una \inglese{entry} di una rubrica utente del sistema mytalk.
	\item{\method{+ getEntry(): IUserData}}\\
	Restituisce un istanza di un oggetto avente tipo \classname{IUserData}, e rappresentante un contatto della rubrica.
	\item{\method{+ setEntry(contact: IUserData): void}}\\
	Imposta l'utente \classname{IUserData} (passato come parametro d'ingresso) come contatto della rubrica.
	\item{\method{+ getGroup(): IGroup}}\\
	Restituisce il gruppo a cui appartiene lo \classname{IUserData} registrato nella rubrica.
	\item{\method{+ setGroup(group: IGroup): void}}\\
	Imposta il gruppo di appartenenza dello \classname{IUserData} registrato nella rubrica.
	\item{\method{+ getOwner(): IUserData}}\\
	Restituisce lo \classname{IUserData} possesore di questa \inglese{entry} della rubrica
	\item{\method{+ setOwner(owner: IUserData ): void}}\\
	Imposta l'utente \classname{IUserData} possessore della entry della rubrica.
\end{description}

\classsection{UserData}

\subsubsection*{Funzione}
Implementazione dell'interfaccia \classname{IUserData}. Un istanza della classe dovrà rappresentare un generico utente del sistema, definendone gli attributi e i metodi per impostare ed ottenere il contenuto dei medesimi.

\subsubsection*{Relazioni d'uso}

\begin{itemize}
	\item{IUserData}: interfaccia da implementare.
\end{itemize}

\subsubsection*{Attributi}

\begin{itemize}
	\item{\memberdata{-- id: long}}
	Attributo che definisce il codice identificativo con il quale l'utente è registrato nel database del sistema.
	\item{\memberdata{-- mail: String}}
	Attributo che definisce l'indirizzo e-mail con il quale l'utente si è registrato nel sistema.
	\item{\memberdata{-- password: String}}
	Attributo che definisce la password per il login dell'utente nel sistema.
	\item{\memberdata{-- question: String}}
	Attributo che definisce la domanda segreta usata dall'utente in caso di smarrimento della password.
	\item{\memberdata{-- answer: String}}
	Attributo che definisce la risposta alla domanda segreta definita nell'attributo \memberdata{question}.
	\item{\memberdata{-- name: String}}
	Attributo che definisce il nome dell'utente.
	\item{\memberdata{-- surname: String}}
	Attributo che definisce il cognome dell'utente.
	\item{\memberdata{-- path: String}}
	Attributo che definisce il percorso (su server) in cui è memorizzata l'immagine del profilo dell'utente.
	\item{\memberdata{-- addressBook: Set<AddressBookEntry>}}
	Attributo che definisce l'insieme di \classname{AddressBookEntry} che costituiscono la rubrica utente.
	
\end{itemize}

\subsubsection*{Metodi}

\begin{description}
	\item{\method{+ getId(): Long}}\\
	Restituisce l'identificatore univoco di un utente, ritornando l'attributo \memberdata{id}.
	\item{\method{\# setId(id: long): void}}\\
	Imposta l'indirizzo l'id con cui l'utente si registra nel sistema mytalk. Il metodo non fa altro che sovrascrivere il contenuto dell'attributo \memberdata{id} con il valore tipo long ricevuto come parametro d'ingresso. ritornando l'attributo \memberdata{id}.
	\item{\method{+ getEmail(): String}}\\
	Restituisce l'indirizzo e-mail con cui uno l'utente si è registrato nel sistema mytalk, ritornando il contenuto dell'attributo \memberdata{mail}.
	\item{\method{+ setEmail(mail: String): void}}\\ 
	Imposta l'indirizzo e-mail con cui l'utente si registra nel sistema mytalk. Il metodo non fa altro che sovrascrivere il contenuto dell'attributo \memberdata{mail} con il valore tipo String ricevuto come parametro d'ingresso.
	\item{\method{+ getPassword(): String}}\\
	Restituisce la password dell'utente, ritornando il valore contenuto nell'attributo \memberdata{password}.
	\item{\method{+ setPassword(password: String): void}}\\
	Imposta la password di accesso al sistema, sovrascrivendo il contenuto dell'attributo \memberdata{password} con il valore di tipo String ricevuto come parametro d'ingresso.
	\item{\method{+ getQuestion(): String}}\\
	Restituisce la domanda segreta, scelta dall'utente, per il recupero della password (smarrita) di accesso al sistema mytalk. Nello specifico il metodo ritorna il contenuto dell'attributo \memberdata{question}.
	\item{\method{+ setQuestion(question: String): void}}\\
	Imposta la domanda segreta da inserire in caso di smarrimento della password. Il metodo sovrascrive il contenuto dell'attributo \memberdata{question} con il valore tipo String ricevuto come parametro d'ingresso
	\item{\method{+ getAnswer(): String}}\\
	Restituisce la risposta alla domanda per il recupero della password (smarrita) di accesso al sistema mytalk. Il metodo non fa altro che ritornare il contenuto dell'attributo \memberdata{answer}.
	\item{\method{+ setAnswer(answer: String): void}}\\
	Imposta la risposta alla domanda segreta per il recupero della password. Il metodo non fa altro che sovrascrivere il contenuto dell'attributo \memberdata{answer} con il valore tipo String passato come parametro d'ingresso.
	\item{\method{+ getName(): String}}\\
	Restituisce il nome dell'utente ritornando il contenuto dell'attributo \memberdata{name}.
	\item{\method{+ setName(name: String): void}}\\
	Imposta il nome dell'utente sovrascrivendo il contenuto dell'attributo \memberdata{name} con il valore tipo String passato al metodo come parametro d'ingresso.
	\item{\method{+ getSurname(): String}}\\
	Restituisce il cognome dell'utente ritornando il contenuto dell'attributo \memberdata{surname}.
	\item{\method{+ setSurname(surname: String): void}}\\
	Imposta il cognome dell'utente sovrascrivendo il contenuto dell'attributo \memberdata{surnamename} con il valore tipo String passato al metodo come parametro d'ingresso.
	\item{\method{+ getPicturePath(): String}}\\
	Restituisce una stringa con il percorso dell'immagine del profilo dell'utente, ritornando il contenuto dell'attributo \memberdata{path}.
	\item{\method{+ setPicturePath(path: String): void}}\\
	Imposta il percorso dell'immagine profilo di un utente, sovrascrivendo il contenuto dell'attributo \memberdata{path} con il valore tipo String passato al metodo come parametro d'ingresso
	\item{\method{+ getState(): State}}\\
	Restituisce lo stato in cui si trova l'utente, ritornando il contenuto dell'attributo \memberdata{state}.
	\item{\method{+ setState(state: State): void}}\\
	Imposta lo stato in cui si trova l'utente, sovrascrivendo il contenuto dell'attributo \memberdata{state} con il valore ricevuto come parametro d'ingresso.
	\item{\method{+ getAddressBook(): Set<AddressBookEntry>}}\\
	Metodo ritorna il contenuto di \memberdata{addressBook}.
	\item{\method{+ addAddressBookEntry(entry: AddressBookEntry): void}}\\
	Metodo usato per aggiungere a \memberdata{addressBook} una nuova \classname{AddressBookEntry} passata come parametro d'ingresso.
	\item{\method{+ toJson(): String}}\\
	Metodo usato per ritornare il contenuto di un istanza di \classname{UserData} sottoforma di stringa formattata in Json. La stringa ritornata deve corrispondere al seguente formato:\\\\
	\verb|{name:"mio_nome",surname:"mio_cognome",email:"mia_mail"|\\\verb|,picturePath:"mia_immagine",id:"mio_id"}|\\
	
	dove i valori tra virgolette rappresentano il contenuto dei rispettivi campi dati contenuti nella classe.
\end{description}

\classsection{Group}

\subsubsection*{Funzione}
Implementazione dell'interfaccia \classname{IGroup}.

\subsubsection*{Relazioni d'uso}

\begin{itemize}
	\item \classname{IGroup}: interfaccia d'implementazione.
\end{itemize}

\subsubsection*{Attributi}

\begin{itemize}
	\item{\memberdata{-- id: long}}
	Attributo del codice identificativo del gruppo.
	\item{\memberdata{-- name: String}}:
	Attributo del nome del gruppo.
\end{itemize}

\subsubsection*{Metodi}

\begin{description}
	\item{\method{+ getId(): Long}}\\
	Restituisce l'identificativo univoco di uno gruppo di una rubrica utente.
	\item{\method{+ getName(): String}}\\
	Restituisce il nome di un gruppo di una rubrica utente.
	\item{\method{+ setName(name: String): void}}\\
	Imposta il nome di un gruppo di una rubrica utente.
	\item{\method{+ toJson(): String}}\\
	Metodo usato per ritornare il contenuto di un istanza di \classname{Group} sottoforma di stringa formattata in Json. La stringa ritornata deve corrispondere al seguente formato:\\\\
	\verb|{id:"mio_id",name:"mio_nome"}|\\
	
	dove i valori tra virgolette rappresentano il contenuto dei rispettivi campi dati contenuti nella classe.
\end{description}

\classsection{AddressBookEntry}

\subsubsection*{Funzione}
Implementazione dell'interfaccia IAddressBookEntry.

\subsubsection*{Relazioni d'uso}

\begin{itemize}
	\item \classname{IAddressBookEntry}: interfaccia d'implementazione della classe.
	\item \classname{IUserData}: usata per definire gli attributi destinati a identificare il possessore dell'istanza di \classname{AddressBookEntry} e il relativo contatto in essa registrato.
\end{itemize}

\subsubsection*{Attributi}

\begin{itemize}
	\item{\memberdata{-- id: long}}
	Attributo del codice identificativo della classe.
	\item{\memberdata{-- group: IGroup}}
	Attributo destinato a identificare il gruppo a cui appartiene il contatto \classname{IUserName} registrato nella classe. Si ricorda che il contatto può anche non appartenere ad alcun gruppo.
	\item{\memberdata{-- contact: IUserData}}
	Attributo destinato ad identificare il contatto registrato nell'istanza di \classname{AddressBookEntry}.
	\item{\memberdata{-- owner: IUserData}}:
	Attributo destinato ad identificare il possessore dell'istanza di \classname{AddressBookEntry}.
	\item{\memberdata{-- blocked: boolean}}
	Attributo booleano necessario per bloccare il contatto. Tale blocco avviene settando l'attributo a \inglese{true}.
\end{itemize}


\subsubsection*{Metodi}

\begin{description}
	\item{\method{+ getId(): Long}}\\
	Restituisce l'identificativo univoco della \inglese{entry} di una rubrica utente del sistema mytalk. Nello specifico restituisce il contenuto dell'attributo \memberdata{id}.
	\item{\method{+ getEntry(): IUserData}}\\
	Restituisce il contenuto dell'attributo \memberdata{contact}.
	\item{\method{+ setEntry(contact: IUserData): void}}\\
	Imposta l'utente \classname{IUserData} (passato come parametro d'ingresso) come contatto della rubrica. Nello specifico imposta il contenuto dell'attributo \memberdata{contact}.
	\item{\method{+ getGroup(): IGroup}}\\
	Restituisce il gruppo a cui appartiene lo \classname{IUserData} registrato nella rubrica. Nello specifico restituisce il contenuto dell'attributo \memberdata{group}.
	\item{\method{+ setGroup(group: IGroup): void}}\\
	Imposta il gruppo di appartenenza dello \classname{IUserData} registrato nella rubrica. Nello specifico imposta il contenuto dell'attributo \memberdata{group}.
	\item{\method{+ getOwner(): IUserData}}\\
	Restituisce lo \classname{IUserData} possesore di questa \inglese{entry} della rubrica. Nello specifico restituisce il contenuto dell'attributo \memberdata{owner}.
	\item{\method{+ setOwner(owner: IUserData ): void}}\\
	Imposta l'utente \classname{IUserData} possessore della entry della rubrica. Nello specifico imposta il contenuto dell'attributo \memberdata{owner}.
	\item{\method{+ toJson(): String}}\\
	Metodo usato per ritornare il contenuto di un istanza di \classname{AddressBookEntry} sottoforma di stringa formattata in Json. La stringa ritornata deve corrispondere al seguente formato:\\\\
	\verb|{id:"mio_id",contact:"mio_contatto",group:"mia_gruppo",blocked:"bloccato"}|\\
	
	dove i valori tra virgolette rappresentano il contenuto dei rispettivi campi dati contenuti nella classe.

\end{description}

\subsection{Package org.softwaresynthesis.mytalk.server.call}\label{sec:call}

\classsection{ICall}

\subsubsection*{Funzione}
Interfaccia che rappresenta una chiamata effettuata dal sistema mytalk. Si ricorda che gli oggetti che implementano tale interfaccia vengono usati per rappresentare lo storico delle chiamate di un utente.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{java.util.Date}: tipo utilizzato per definire la data d'inizio e fine di una chiamata.
\end{itemize}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ getId(): Long}}\\
	Restituisce l'identificativo univoco della chiamata.
	\item{\method{+ getStartDate(): Date}}\\
	Restituisce un istanza di \texttt{java.util.Date} di avvio della chiamata.
	\item{\method{+ setStartDate(startDate: Date): void}}\\
	Imposta la data di avvio della chiamata.
	\item{\method{+ getEndDate(): Date}}\\
	Restituisce la data di terminazione della chiamata
	\item{\method{+ setEndDate(endDate: Date): void}}\\
	Imposta la data di terminazione della chiamata.
\end{description}

\classsection{Call}

\subsubsection*{Funzione}
Classe che implementa l'interfaccia \classname{ICall}.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{java.util.Date}: tipo utilizzato per definire la data d'inizio e fine di una chiamata.
\end{itemize}

\subsubsection*{Attributi}

\begin{itemize}
	\item{\memberdata{-- id: long}}
	Attributo contenente il codice identificativo della chiamata.
	\item{\memberdata{-- startDate: Date}}
	Attributo di tipo \texttt{java.util.Date} contenente la data (compresa l'ora) d'inizio della chiamata.
	\item{\memberdata{-- endDate: Date}}
	Attributo di tipo \texttt{java.util.Date} contenente la data (compresa l'ora) in cui la chiamata è terminata.
\end{itemize}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ getId(): Long}}\\
	Restituisce l'identificativo univoco della chiamata ritornando il contenuto dell'attributo \memberdata{id}.
	\item{\method{+ getStartDate(): Date}}\\
	Restituisce il contenuto del campo \memberdata{startDate}.
	\item{\method{+ setStartDate(startDate: Date): void}}\\
	Imposta la data di avvio della chiamata, sovrascrivendo il contenuto \memberdata{startData}.
	\item{\method{+ getEndDate(): Date}}\\
	Restituisce il contenuto del campo \memberdata{endDate}.
	\item{\method{+ setEndDate(endDate: Date): void}}\\
	Imposta la data di avvio della chiamata, sovrascrivendo il contenuto \memberdata{endData}.
\end{description}

\subsection{Package org.softwaresynthesis.mytalk.server.message}\label{sec:message}

\classsection{IMessage}

\subsubsection*{Funzione}
Interfaccia che rappresenta un messaggio di segreteria del sistema mytalk.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{java.util.Date}: tipo utilizzato per definire la data in cui è stato registrato un messaggio.
	\item \classname{abook.IUserData}: usata per rappresentare il mittente e il destinatario del messaggio di segreteria.
\end{itemize}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ getId(): Long}}\\
	Restituisce l'identificativo univoco del messaggio.
	\item{\method{+ getSender(): IUserData}}\\
	Restituisce un istanza di tipo classname{abook.IUserData} che rappresenta il mittente del messaggio.
	\item{\method{+ setSender(sender: IUserData): void}}\\
	Imposta il mittente del messaggio.
	\item{\method{+ getReceiver(): IUserData}}\\
	Restituisce un istanza di tipo classname{abook.IUserData} che rappresenta il destinatario del messaggio.
	\item{\method{+ setReceiver(receiver: IUserData): void}}\\
	Imposta il destinatario del messaggio.
	\item{\method{+ isNew(): boolean}}\\
	Restituisce un valore booleano che identifica lo stato del messaggio (``già letto'' se il valore ritornato è \inglese{true}, ``da leggere'' se il valore ritornato è \inglese{false}).
	\item{\method{+ setNew(status: boolean): void}}\\
	Imposta il messaggio come ``già ascoltato'' o come ``da ascoltare''.
	\item{\method{+ isVideo(): boolean}}\\
	Restituisce un booleano che determina se si tratta di un messaggio audio oppure audio-video.
	\item{\method{+ setVideo(video: boolean): void }}\\	
	Imposta il messaggio come messaggio audio-video o come messaggio contenente solamente una traccia audio.
	\item{\method{+ getDate(): Date}}\\
	Restituisce la data in cui il mittente ha lasciato il messaggio nella segreteria del destinatario.
	\item{\method{+ setDate(date: Date): void}}\\
	Imposta la data in cui il mittente ha lasciato il messaggio nella segreteria del destinatario.
\end{description}

\classsection{Message}

\subsubsection*{Funzione}
Classe che implementa l'interfaccia \classname{IMessage}.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{java.util.Date}: tipo utilizzato per definire la data in cui è stato registrato un messaggio.
	\item \classname{abook.IUserData}: usata per rappresentare il mittente e il destinatario del messaggio di segreteria.
\end{itemize}

\subsubsection*{Attributi}

\begin{itemize}
	\item{\memberdata{-- id: long}}
	Attributo contenente il codice identificativo del messaggio.
	\item{\memberdata{-- sender: IUserData}}
	Attributo contenente lo \classname{IUserData} che rappresenta il destinatario del messaggio.
	\item{\memberdata{-- receiver: IUserData}}
	Attributo contenente lo \classname{IUserData} che rappresenta il destinatario del messaggio.
	\item{\memberdata{-- status: boolean}}
	Attributo contenente un valore booleano che identifica se il messaggio è stato visionato/ascoltato o meno. L'attributo se impostato a \inglese{true}, designa il messaggio come ``ascoltato''. Invece se impostato a false identifica il messaggio come ``ancora da ascoltare''.
	\item{\memberdata{-- video: boolean}}
	Attributo che stabilisce se il messaggio contiene o meno una traccia video. Si ricorda che ogni messaggio contiene (di \inglese{default}) una traccia audio. Se tale attributo è impostato a \inglese{true} allora il messaggio contiene una traccia video.
	\item{\memberdata{-- date: Date}}
	Attributo che definisce l'orario di invio del messaggio.
\end{itemize}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ getId(): Long}}\\
	Restituisce l'identificativo univoco del messaggio, ritornando il contenuto di \memberdata{id}.
	\item{\method{+ getSender(): IUserData}}\\
	Restituisce un istanza di tipo classname{abook.IUserData} che rappresenta il mittente del messaggio. Nello specifico il metodo ritorna l'attributo \memberdata{sender}.
	\item{\method{+ setSender(sender: IUserData): void}}\\
	Imposta il mittente del messaggio, sovrascrivendo il contenuto dell'attributo \memberdata{sender}.
	\item{\method{+ getReceiver(): IUserData}}\\
	Restituisce un istanza di tipo classname{abook.IUserData} che rappresenta il destinatario del messaggio. Nello specifico il metodo ritorna l'attributo \memberdata{receiver}.
	\item{\method{+ setReceiver(receiver: IUserData): void}}\\
	Imposta il destinatario del messaggio, sovrascrivendo il contenuto dell'attributo \memberdata{receiver}.
	\item{\method{+ isNew(): boolean}}\\
	Metodo che ritorna il contenuto dell'attributo \memberdata{status}.
	\item{\method{+ setNew(status: boolean): void}}\\
	Imposta il messaggio come ``già ascoltato'' o come ``da ascoltare'', sovrascrivendo il contenuto dell'attributo \memberdata{status}.
	\item{\method{+ isVideo(): boolean}}\\
	Restituisce il contenuto dell'attributo \memberdata{video}.
	\item{\method{+ setVideo(video: boolean): void }}\\	
	Metodo usato per impostare la ``natura'' del messaggio. Nello specifico il metodo imposta il contenuto dell'attributo \memberdata{video} mettendolo a \inglese{true} se il messaggio contiene una traccia video, oppure a \inglese{false} se non la contiene.
	\item{\method{+ getDate(): Date}}\\
	Restituisce la data in cui il mittente ha lasciato il messaggio nella segreteria del destinatario, ritornando il contenuto dell'attributo \memberdata{date}.
	\item{\method{+ setDate(date: Date): void}}\\
	Imposta la data in cui il mittente ha lasciato il messaggio nella segreteria del destinatario, sovrascrivendo il contenuto dell'attributo \memberdata{date}.

\end{description}

\subsection{Package org.softwaresynthesis.mytalk.server.authentication}\label{sec:authentication}

\classsection{ISecurityStrategy}

\subsubsection*{Funzione}
Interfaccia che identifica il comportamento di una strategia generica di crittografia dei dati.

\subsubsection*{Relazioni d'uso}
Nessuna relazione d'uso evidenziata.

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ encrypt(plainText: String): String}}\\
	Cripta la stringa di testo ricevuta come parametro.\\\\
	Il metodo può lanciare eccezioni:
	\begin{itemize}
		\item \exception{Exception}: il metodo può lanciare un'eccezione generica.
	\end{itemize}
	\item{\method{+ decrypt(encryptedText: String)}}\\
	Decripta la stringa di testo ricevuta come parametro.\\\\
	Il metodo può lanciare eccezioni:
	\begin{itemize}
		\item \exception{Exception}: il metodo può lanciare un'eccezione generica.
	\end{itemize}
\end{description}

\classsection{AESAlgorithm}

\subsubsection*{Funzione}
Implementazione della strategia di codifica/decodifica con l'uso dell'algoritmo AES a 128bit.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \classname{ISecurityStrategy}: interfaccia d'imlementazione
	\item \texttt{java.security.Key}: usata per creare un istanza di una chiave durante il processo di criptazione.
	\item \texttt{javax.crypto.Cipher}: usata per creare un istanza di un oggetto di criptazione che implementa l'algoritmo AES a 128 bit.
	\item \texttt{javax.crypto.spec.SecretKeySpec}: usata dall'algoritmo di per costruire una chiave segreta a partire da un array di byte.
	\item \texttt{sun.misc.BASE64Encoder}: utilizzata per eseguire una trasformazione da stringa a byte.
	\item \texttt{sun.misc.BASE64Decoder}: utilizzata per eseguire una trasformazione da byte in stringa.
\end{itemize}

\subsubsection*{Attributi}
\begin{description}
  \item{\memberdata{-- \{frozen\} \underline{keyValue}: byte[]}}\\
  Array di byte usato per definire il valore della chiave su cui si basa l'algoritmo AES di criptazione. La chiave effettiva sarà creata a partire da tale attributo, per mezzo della classe \texttt{javax.crypto.spec.SecretKeySpec}.
  \item{\memberdata{-- \{frozen\} \underline{algorithm}: String}}\\
  Stringa costante che identifica il nominativo dell'algoritmo usato, e che dovrà essere specificato durante l'uso di \texttt{javax.crypto.Cipher}. l'attributo avrà valore ``AES''.
\end{description}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{- generateKey(): Key}}\\
	Metodo che restituisce una chiave di tipo \texttt{java.security.Key}, a partire dall'array \memberdata{keyValue}. Per fare ciò, il metodo usa il costruttore di \texttt{javax.crypto.spec.SecretKeySpec}.
	Il metodo può lanciare eccezioni:
	\begin{itemize}
		\item \exception{Exception}: il metodo può lanciare un'eccezione generica.
	\end{itemize}
	\item{\method{+ encrypt(plainText: String): String}}\\
	Metodo usato per criptare un testo di tipo String passato come parametro d'ingresso. Il metodo usa una chiave ottenuta a partire dal metodo \method{generateKey()} in associazione alla classe \texttt{javax.crypto.Cipher} per criptare il testo tramite l'algoritmo AES.
	\begin{itemize}
		\item \exception{Exception}: il metodo può lanciare un'eccezione generica.
	\end{itemize}
	\item{\method{+ decrypt(encryptedText: String)}}\\
	Decripta la stringa di testo ricevuta come parametro, attuando una procedura inversa a quella presentata nel metodo \method{encrypt(plainText: String)}\\\\
	Il metodo può lanciare eccezioni:
	\begin{itemize}
		\item \exception{Exception}: il metodo può lanciare un'eccezione generica.
	\end{itemize}
\end{description}

\classsection{PrincipalImpl}

\subsubsection*{Funzione}
Oggetto che permette di identificate univocamente uno IUserData memorizzato nel database del sistema mytalk.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{java.io.Serializable}: interfaccia d'implementazione usata per rendere serializzabili le istanze della classe.
	\item \texttt{java.security.Principal}: interfaccia d'implementazione usata per rendere caratterizzante le istanze della classe.
\end{itemize}

\subsubsection*{Attributi}
\begin{description}
  \item{\memberdata{-- \{frozen\} \underline{serialVersionUID}: long}}\\
  Identificativo univoco per la classe, usato al fine di rendere l'oggetto serializzabile.
  \item{\memberdata{-- mail: String}}\\
  Attributo che rappresenta l'indirizzo e-mail dell'utente.
\end{description}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ PrincipalImpl(mail: String)}}\\
	Classe costruttore. crea un oggetto PrincipalImpl che permetterà di determinare univocamente lo IUserData che ha effettuato il login.
	\item{\method{+ getName(): String}}\\
	Restituisce l'elemento identificativo (mail dell'utente) dello IUserData che ha effettuato la procedura di login.
	\item{\method{+ equals(obj: Object): boolean}}\\
	Verifica l'uguaglianza di due oggetti PrincipalImpl sulla base di un confronto tra gli indirizzi mail degli utenti confrontati.
	\item{\method{+ hashCode(): int}}\\
	Restituisc eil codice hash dell'oggetto di invocazione.				\item{\method{+ toString(): String}}\\
	Restituisce l'istanza dell'oggetto sotto forma di stringa. In particolare evidenziando l'indirizzo e-mail dell'utente.
\end{description}

\classsection{IAuthenticationData}

\subsubsection*{Funzione}
Interfaccia che identifica il comportamento di un oggetto adatto alla definizione dei dati di autenticazione di un utente.

\subsubsection*{Relazioni d'uso}
Nessuna relazione d'uso evidenziata.

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ getUsername(): String}}\\
Restituisce lo username fornito in input dall'utente durante la procedura di login.
	\item{\method{+ getPassword(): String}}\\
Restituisce la password fornita in input dall'utente durante la procedura di login
\end{description}

\classsection{AuthenticationData}

\subsubsection*{Funzione}
Oggetto contenente i dati di accesso utilizzati da un utente che vuole accedere al sistema mytalk.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \classname{IAuthenticationData}: interfaccia da implementare.
\end{itemize}

\subsubsection*{Attributi}
\begin{description}
  \item{\memberdata{-- username: String}}\\
	Attributo contenente l'username dell'utente che richiede l'autenticazione.
  \item{\memberdata{-- password: String}}\\
	Attributo contenente la password dell'utente che richiede l'autenticazione.
\end{description}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ AuthenticationData(username: String, password: String)}}\\
	Costruttore pubblico che per creare un istanza di AuthenticationData, si basa sulla password e lo username dell'utente da autenticare.

	\item{\method{+ getUsername(): String}}\\
	Metodo che restituisce lo username dell'oggetto di autenticazione.
	
	\item{\method{+ getPassword(): String}}\\
	Metodo che Restituisce la password dell'utente che sta effettuando la prodedura di login.

	\item{\method{+ hashCode(): int}}\\
	Restituisce il codice hash di questa istanza.
	
	\item{\method{+ equals(Object obj): boolean}}\\
	Determina l'uguaglianza di due istanze, effettuando un confronto tra l'oggetto stesso da cui è chiamato il metodo, e un Object obj ricevuto come parametro d'ingresso.
	
	\item{\method{+ toString: String}}\\
	Metodo che Restituisce l'istanza sotto forma di stringa. Si osservi che il metodo non dovrà ritornare la password, ma solo lo username dell'utente da autenticare.

\end{description}

\classsection{AuthenticationModule}

%TODO definire questa parte tramite intervista a Mene.

\subsubsection*{Funzione}
Modulo di autenticazione utilizzato dal sistema mytalk.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{java.io.IOException}:
	\item \texttt{java.security.Principal}:
	\item \texttt{java.util.Map}:
	\item \texttt{java.util.Set}:
	\item \texttt{javax.security.auth.callback.Callback}:
	\item \texttt{javax.security.auth.callback.CallbackHandler}:
	\item \texttt{javax.security.auth.callback.NameCallback}:
	\item \texttt{javax.security.auth.callback.PasswordCallback}:
	\item \texttt{javax.security.auth.callback.UnsupportedCallbackException}:
	\item \texttt{javax.security.auth.login.FailedLoginException}:
	\item \texttt{javax.security.auth.login.LoginException}:
	\item \texttt{javax.security.auth.spi.LoginModule}:
	\item \texttt{javax.security.auth.Subject}:
	\item \classname{abook.IUserData}:
	\item \classname{dao.UserDataDAO}:
\end{itemize}

\subsubsection*{Attributi}
\begin{description}
  \item{\memberdata{-- login: boolean}}\\
  \item{\memberdata{-- commit: boolean}}\\
  \item{\memberdata{-- handler: CallbackHandler}}\\
  \item{\memberdata{-- password: char[]}}\\
  \item{\memberdata{-- username: String}}\\
  \item{\memberdata{-- principal: Principal}}\\
  \item{\memberdata{-- subject: Subject}}\\
\end{description}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ initialize(subject: Subject, handler: CallbackHandler, sharedState: Map, option: Map): void }}\\

	\item{\method{+ login(): boolean throws LoginException}}\\
	
	\item{\method{+ commit(): boolean throws LoginException}}\\
	
	\item{\method{+ abort(): boolean throws LoginException}}\\
	
	\item{\method{+ logout(): boolean throws LoginException}}\\

\end{description}

\classsection{CredentialLoader}

\subsubsection*{Funzione}
Permette di caricare le credenziali di autenticazione, fornite dall'utente, per preparare la fase di login.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{javax.security.auth.callback.Callback}: usato durante la procedura di inserimento dati.
	\item \texttt{javax.security.auth.callback.CallbackHandler}: Interfaccia implementata dalla classe.
	\item \texttt{javax.security.auth.callback.NameCallback}: tipo di dato richiesto in ingresso per completare la parte di login.
	\item \texttt{javax.security.auth.callback.PasswordCallback}: tipo di dato richiesto in ingresso per completare la parte di login.
	\item \texttt{java.io.IOException}: eccezione che può essere lanciata dal metodo handle definito dall'interfaccia \texttt{javax.security.auth.callback.CallbackHandler}.
	\item \texttt{javax.security.auth.callback.UnsupportedCallbackException}: eccezione che può essere lanciata dal metodo handle definito dall'interfaccia \texttt{javax.security.auth.callback.CallbackHandler}.
\end{itemize}

\subsubsection*{Attributi}
\begin{description}
  \item{\memberdata{-- credential: AuthenticationData}}\\
  Attributo contenente i dati da autenticare per la login dell'utente.
  \item{\memberdata{-- security: ISecurityStrategy}}\\
  Attributo che contiene un oggetto che definisce un algoritmo di criptazione per i dati. Necessario per criptare i dati di autenticazione.
\end{description}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ CredentialLoader(credential: AuthenticationData, security: ISecurityStrategy)}}\\
	Costruttore pubblico. Crea un istanza con le credenziali fornite dall'utente (fornite in fase di login).

	\item{\method{+ handle(callbacks: Callback[]): void}}\\
	Effettua il caricamento e crittografa le credenziali fornite dall'utente per la fase di login\\\\
	Il metodo può lanciare eccezioni:
	\begin{itemize}
		\item \exception{IOException}
		\item \exception{UnsupportedCallbackException}
	\end{itemize}

\end{description}

\classsection{LoginManager}

\subsubsection*{Funzione}
\inglese{Servlet} da richiamare per effettuare la login e la corrispettiva autenticazione dell'utente.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{java.io.IOException}: eccezione richiamabile dai metodi \method{doPost()} e \method{doGet()}.
	\item \texttt{java.io.PrintWriter}: classe istanziata all'interno del metodo \method{doPost()}. Usata per scrivere l'output della \inglese{servlet}.
	\item \texttt{javax.security.auth.login.LoginContext}: classe usata in \method{doPost()} per avviare la login dell'utente.
	\item \texttt{javax.servlet.ServletException}: eccezione rilancibile dai metodi \method{doPost()} e \method{doGet()}.
	\item \texttt{javax.servlet.http.HttpServlet}: classe estesa da \classname{LoginManager}.
	\item \texttt{javax.servlet.http.HttpServletRequest}:  classe per usata per la comunicazione con la \inglese{servlet} (inoltra i dati in ingresso alla \inglese{servlet}).
	\item \texttt{javax.servlet.http.HttpServletResponse}: classe per usata per la comunicazione con la servlet (inoltra i dati in uscita dalla chiamata a servlet).
	\item \texttt{javax.servlet.http.HttpSession}: classe usata per definire una sessione HTTP.
	\item \classname{abook.IUserData}: usata per definire un utente.
	\item \classname{dao.UserDataDAO}: usata per comunicare tramite Hibernate con la tabella UserData della base di dati.
\end{itemize}

\subsubsection*{Attributi}
\begin{description}
  \item{\memberdata{\underline{-- {frozen} serialVersionUID: long}}}\\
  Utilizzato come ID univoco per identificare un oggetto serializzabile.
\end{description}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ LoginManager()}}\\
	Costruttore della classe. Richiama il costruttore della classe padre \texttt{HttpServlet}.
	
	\item{\method{\# doGet(request: HttpServletRequest, response: HttpServletResponse): void}}\\
	Metodo di delega che richiama \method{doPost()} passando gli stessi dati in input.
	
	\item{\method{\# doPost(request: HttpServletRequest, response: HttpServletResponse): void}}\\
	Metodo che costituisce il kernel logico di risposta della \inglese{servlet}. Il metodo inizia caricando un istanza di Object i parametri ricevuti mediante \texttt{HttpServletRequest}. Quindi verifica che il parametro ricevuto sia un istanza di \texttt{Integer}, e procede valutando il valore in essa contenuto. La logica di sistema considera 2 possibili valori:
	\begin{itemize}
		\item[•]type = 0: corrisponde ad una richiesta di logout e si attua impostando a false la sessione contenuta nell'oggetto HttopServletRequest request. Quindi si passa tale sessione (come parametro d'ingresso) al metodo \method{doLogout()}. Il metodo termina invalidando la sessione richiamando il metodo \texttt{invalidate()} di HttpSession.
		\item[•]type = 1: corrisponde ad una richiesta di login e si attua impostando due campi String con i dati ottenuti da una chiamata a \texttt{getParameter(``username'')} e \texttt{getParameter(``password'')} . Quindi si crea un istanza di \texttt{HttpSession} tramite il metodo \texttt{getSession(true)} del parametro request. Il metodo prosegue controllando se l'username e la password precedentemente ottenute hanno valore diverso da null. Nel caso il flusso principale continua richiamando \method{doLogin()}.
	\end{itemize}
	
	\item{\method{-- doLogin(session: HttpSession, username: String, password: String): String}}\\
	Metodo per l'autenticazione dei dati utente e il completamento della fase di login. Il metodo inizia creando un'istanza di \classname{AutenthicationData} (denominata credential) a partire dai parametri username e password ricevuti da input. Quindi si carica la path del file di configurazione in un apposita stringa \texttt{pathFileConfig}, tramite la chiamata a metodo:\\
	
\verb|System.getenv("MyTalkConfiguration") + "\\LoginConfiguration.conf"|.\\

Il flusso principale prosegue all'interno di un blocco \texttt{try-catch} creando:
	\begin{itemize}
		\item[•] un \classname{CredentialLoader} (loader);
		\item[•] un \classname{LoginContext} (context);
		\item[•] un \classname{dao.UserDataDao} (user);
	\end{itemize}
Quindi tramite context si esegue il login e si impostano gli attributi di sessione come segue: 

\texttt{session.setAttribute("LoginContext", context);}

Infine si carica in user un istanza di \classname{dao.UserDataDAO} ottenuta dalla chiamata a metodo \method{UserDataDAO.getByEmail()}, e restituendo user in un formato di formattazione \texttt{Json} (\texttt{user.toJson()}).
	
	\item{\method{-- doLogout(session: HttpSession)}}\\
	Metodo richiamato da un client per eseguire il logout dal sistema. Il metodo deve iniziare tramite la definizione di un istanza  di \texttt{LoginContext} denominata context. Quindi il metodo procede effettuando la memorizzazione dell'oggetto ritornato da una chiamata
\\
\verb|session.getAttribute("LoginContext");|
\\

L'oggetto cosi ottenuto dovrà essere controllato, ovvero si dovrà accertare che il tipo dinamico è conforme al tipo \texttt{LoginContext} (il programmatore dovrà obbligatoriamente usare   la primitiva \texttt{istanceof}). Quindi si sovrascrive il contenuto di context con quanto ottenuto dalla chiamata a metodo sopracitata, e si richiama il metodo \texttt{logout()} a partire dall'oggetto context.


\end{description}

\subsection{Package org.softwaresynthesis.mytalk.server.connection}\label{sec:connection}

\classsection{PushInbound}

\subsubsection*{Funzione}
Classe per la definizione di un apposito canale di comunicazione client-server. La classe è un'estensione di \texttt{org.apache.catalina.websocket.MessageInbound}, che verrà usata poi in \classname{ChannelServlet}. Si osservi che l'associazione tra un istanza di \classname{PushInbound} e un utente del sistema è univoca: fintanto che connesso un utente ha un proprio \classname{PushInbound} presente sul server, che è suo e suo soltanto.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{java.io.IOException}: Eccezione lanciabile dal metodo \method{OnTextMessage()}.
	\item \texttt{java.nio.CharBuffer}: tipologia di buffer usata per memorizzare il messaggio ricevuto come parametro d'ingresso.
	\item \texttt{java.util.Iterator}: usata per scorrere il contenuto dell'insieme di \classname{AddressBookEntry}
	\item \texttt{java.util.Set}: struttura dati usata per memorizzare le \inglese{entry} (\classname{AddressBookEntry}) che costituiscono la rubrica dell'utente.
	\item \texttt{org.apache.catalina.websocket.MessageInbound}: classe da estendere. Aggiunge alla classe \classname{PushInbound} le funzionalità necessarie per fare di lei un ``canale di comunicazione'' usabile dai client.
	\item \texttt{com.google.gson.*}: usata per convertire i dati interni in una stringa formato json.
	\item \classname{State}: classe interna utilizzata per rappresentare lo stato dell'utente a cui è associata l'istanza di \classname{PushInbound}. Un utente ha uno stato fintanto che è connesso (quindi fintanto che esiste sul server un'istanza di \classname{PushInbound}  ad esso associata). Gli stati possibili sono: AVAILABLE (utente connesso e libero, quindi disposto a ricevere chiamate) e OCCUPIED (utente connesso ma attualmente occupato in un'altra conversazione).
	\item \classname{abook.AddressBookEntry}: usata per definire la rubrica dell'utente, richiamata dal metodo \method{onTextMessage} nel momento in cui c'è la necessità di aggiornare lo stato dell'utente e renderlo visibile ai suoi contatti.
	\item \classname{abook.IUserData}: usata per riferire un istanza della classe ad un particolare utente.
	\item \classname{dao.UserDataDAO}: usata per riferire un istanza della classe ad un particolare utente.

\end{itemize}

\subsubsection*{Attributi}
\begin{description}
  \item{\memberdata{-- id: Long}}\\
  Identificativo di tipo Long, del canale di comunicazione associato ad un client univoco.
  \item{\memberdata{-- state: State}}\\
  Attributo usato per memorizzare lo stato dell'utente ``proprietario'' del \classname{PushInbound}.
\end{description}

%TODO da rivedere.

\subsubsection*{Metodi}
\begin{description}

	\item{\method{+ setId(n: Long): void}}\\
	Metodo per impostare il valore contenuto nell'attributo \memberdata{id}.
	
	\item{\method{+ getId(): Long}}\\
	Metodo che ritorna il contenuto dell'attributo \memberdata{id}.
	
	\item{\method{+ onTextMessage(message: CharBuffer): void}}\\
	Metodo invocato al momento della ricezione di un messaggio da parte del client. Il metodo riceve in input un oggetto di tipo \texttt{CharBuffer} contenente il messaggio inviato dal client.	Inizialmente il metodo crea un istanza per ognuno dei seguenti oggetti:
	\begin{itemize}
		\item[•]\texttt{Gson}: tipo di Json ``particolare'' definito da google;
		\item[•]\texttt{JsonParser}: parser usato per scorrere il contenuto di una stringa Json;
		\item[•]\texttt{JsonArray}: array popolato a partire dal \inglese{parsing} della stringa di messaggio data in input.
	\end{itemize}
	
	Prima di procedere si voglia considerare quanto segue: il metodo dopo aver ``segmentato'' il messaggio ricevuto in input, si occupa di esaminarne il contenuto che può essere di 5 tipologie, ciascuna identificata tramite un valore intero positivo da 1 a 5. Tale valore viene deve essere salvato nell'istanza di \texttt{JsonArray}
	Detto ciò, tornando a definire il flusso principale del metodo, si osservi che il :

	\begin{itemize}
		\item[•]Se la richiesta inoltrata è del tipo 1: il metodo prende in lettura il messaggio e imposta il contenuto di \memberdata{id} con il valore letto mediante procedura di parsing, analoga a quella definita al passo precedente. Per farlo utilizza il metodo \texttt{fromJson} richiamato dall'istanza gsonObj di tipo \texttt{Gson} creata al passo precedente. A tale metodo passa il contenuto dell'array, e in particolare ciò che è salvato nella posizione 1 (utilizzo di metodo \texttt{get(int i)}).
		\item[•]Se la richiesta inoltrata è del tipo 2: il metodo procede con le istruzioni necessarie a scambiare i dati per la chiamata. Nello specifico viene salvato in un attributo di tipo \texttt{Long}, l'id del client che desidero chiamare. Quindi ricerco l'oggetto \texttt{PushInbound} associato al client che desidero contattare, e gli inoltro il messaggio ricevuto come parametro d'ingresso.
		\item[•]Se la richiesta inoltrata è del tipo 3: il metodo comunica al client ``destinatario'' della chiamata, l'id del client chiamante. La procedura è analoga a quella identificata nel punto precedente, con la specifica che il messaggio inoltrato è l'identificativo del cliente che desidera avviare la chiamata.
		\item[•]Se la richiesta inoltrata è del tipo 4: il metodo si occupa dell'eliminazione della webSocket, contattando l'istanza \classname{ChannelServlet} associata a questo \texttt{PushInbound}.
		\item[•]Se la richiesta inoltrata è del tipo 5: il metodo viene usato per modificare lo stato dell'utente, con il valore passato tramite messaggio. Dopo la ricezione del messaggio, il metodo cambia il valore del campo \texttt{state} con il valore ricevuto come parametro d'ingresso. Quindi procede ricavando la lista degli ``amici'' dell'utente che ha cambiato stato, e comunica loro che è avvenuto un cambiamento di stato.
	\end{itemize}
\end{description}

\classsection{ChanelServlet}

\subsubsection*{Funzione}
\inglese{Servlet} per la gestione delle connessioni. Richiamata dai client per ottenere le informazioni necessarie a stabilire una comunicazione client-client.

\subsubsection*{Relazioni d'uso}
\begin{itemize}
	\item \texttt{java.util.Vector}: vettore usato per memorizzare i \texttt{PushInBound} creati all'interno della classe.
	\item \texttt{javax.servlet.Servlet}: interfaccia d'implementazione. Necessaria per definire la classe come \inglese{servlet}.
	\item \texttt{javax.servlet.ServletConfig}: classe per la configura della \inglese{servlet}. 
	\item \texttt{javax.servlet.ServletException}: eccezione richiesta per la firma del metodo \method{init} (metodo richiesto per implementazione dell'interfaccia \texttt{javax.servlet.Servlet}.
	\item \texttt{javax.servlet.annotation.WebServlet}: necessaria per definire la servlet come \texttt{WebServlet}.
	\item \texttt{javax.servlet.http.HttpServletRequest}: necessaria per definire le richieste inoltrate alla classe (richieste a \inglese{servlet}).
	\item \classname{org.apache.catalina.websocket.StreamInbound}: classe utilizzata per definire un canale di comunicazione server-client.
	\item \classname{org.apache.catalina.websocket.WebSocketServlet}: classe da estendere per utilizzare i metodi di comunicazione tramite \inglese{webSocket}.
\end{itemize}

\subsubsection*{Attributi}
\begin{description}
  \item{\memberdata{\underline{-- \{frozen\} serialVersionUID: long}}}\\
  Utilizzato come ID univoco per identificare un oggetto serializzabile.
  \item{\memberdata{\underline{-- \{frozen\} clients: Vector<PushInbound>}}}\\
  Vettore contenente i canali di comunicazione server-client. Un canale di comunicazione \texttt{PushInbound} viene creato dal Server al momento dell'autenticazione di un utente (al quale poi viene associato).
\end{description}

\subsubsection*{Metodi}
\begin{description}
	\item{\method{+ ChannelServlet()}}\\
	Costruttore della Servlet. Richiama \method{super()}.
	
	\item{\method{\# createWebSocketInbound(subProtocol: String, request: HttpServletRequest): StreamInbound}}\\
	Metodo per la creazione di una websocket. Il metodo ha anche il compito di salvare nel vettore di connessioni attive e la ritorna al client. Nello specifico il server segue l'iter:
	
	\begin{itemize}
		\item[1)] creazione di un PushInbound;
		\item[2)] aggiungo l'oggetto creato al punto precedente, al vettore di PushInbound \memberdata{clients};
		\item[3)] il metodo termina ritornando l'istanza di PushInbound creata al punto 1.
	\end{itemize}
	
	\item{\method{\underline{ + findClient(n: Long): PushInbound}}}\\
	Metodo per la ricerca di una connessione client, dato l'identificativo dell'utente. Il metodo esegue una ricerca (mediante ciclo for) all'interno del vettore \memberdata{clients}. Ad ogni iterazione verifica se l'istanza i-esima presa in esame, ha un campo id che corrisponde a quello dato in input come parametro di ricerca. Il metodo termina ritornando il PushInbound associato al client, se si verifica l'effettiva essitenza di un client con id uguale a quello passato in input, \inglese{null} altrimenti.
	
	\item{\method{\underline{ + removeClient(c: PushInbound): void}}}\\
	Metodo per la rimozione di un oggetto PushInbound dal vettore \memberdata{clients}. Il metodo esegue una ricerca tramite ciclo for (analoga a quella eseguita nel metodo \method{findClient}. Se la ricerca ha esito positivo il metodo termina eseguendo la rimozione dell'istanza dall'oggetto \memberdata{clients} tramite la chiamata a metodo \texttt{remove}.
\end{description}

\clearpage

\section{Specifica sotto-architettura clientpresenter}\label{sec:clientpresenterarchitecture}

La \texttt{sotto-architettura clientpresenter}, a livello di definizione di prodotto, richiede una trattazione speciale a causa del particolare dominio tecnologico coinvolto. Essa è infatti definita con il linguaggio JavaScript. Tale linguaggio pur essendo definito come linguaggio orientato agli oggetti, non permette di definire classi. A ciò si aggiunge il fatto che JavaScript è debolmente tipizzato. In ragione di ciò, al fine di facilitare al programmatore la comprensione del progetto (pesando quindi alle varie entità come a classi) senza però confonderlo in fase di stesura del codice, si è pensato di adoperare la seguente terminologia.

\begin{description}
	\item{\scshape\bfseries Attributi}: saranno definiti con una sintassi simile a quella già usata. Quindi al nome dell'attributo sarà associato il tipo ``logico'' che idealmente rappresenta. In particolare emergono i seguenti casi:
		\begin{itemize}
			\item Nodi DOM: come si vedrà alcuni attributi rappresentano nodi DOM già esistenti nella pagina HTML che definisce l'interfaccia utente, e modificati (a run-time) sulla base di informazioni ottenute dal server. Tali attributi dovranno essere codificati come:
			
			\begin{verbatim}
				this.mio_attributo = document.getElementById(``id_DOM'');
			\end{verbatim}
			
			Tali attributi saranno indicati con il formalismo:
			
			\begin{verbatim}
				(+, -, #) nome_atributo: Nodo_DOM
			\end{verbatim}
			
			\item String: se l'attributo è destinato a contenere esclusivamente valori di tipo String sarà segnato nel documento come:
			
			\begin{verbatim}
				(+, -, #) nome_atributo: String
			\end{verbatim}
			
			\item Array: se l'attributo è un Array, che in JavaScript non chiede di essere definito per tipo di valori contenibili, nel documento sarà precisato come:
			
			\begin{verbatim}
				(+, -, #) nome_atributo: Tipo[]
			\end{verbatim}
		\end{itemize}
	\item{\scshape\bfseries Metodi}: la sintassi usata dal programmatore per definire un metodo in JavaScript dovrà essere la seguente:
		\begin{verbatim}
			var nome_metodo = function(){ contenuto }
		\end{verbatim}
		
		mentre la sintassi usata nel documento per definirne la firma, resta la stessa usata in precedenza.
	
\end{description}

\subsection{Package org.softwaresynthesis.mytalk.clientpresenter.guicontrol}\label{sec:authentication}

\classsection{AddressBookPanelPresenter}

\subsubsection*{Funzione}
Presenter incaricato di gestire il pannello della rubrica, contiene le funzioni associate ai \inglese{widget} grafici della vista relativi alla rubrica e ha la responsabilità di aggiornare la vista sulla base dei dati ricevuti dal server.

\subsubsection*{Relazioni d'uso}
Nessuna relazione d'uso evidenziata.

\subsubsection*{Attributi}
\begin{description}

  \item{\memberdata{-- element: DOM\_node}}\\
  Attributo che definisce il contenuto del nodo DOM inerente alla rappresentazione della rubrica. Nello specifico tale nodo corrisponde ad un \texttt{div} con id \texttt{AddressBookPanel}.
  \item{\memberdata{-- urServlet: String}}\\
  Attributo che definisce l'URL dal quale è richiamabile la servlet usata per interagire con l'apparato server del sistema.
  \item{\memberdata{-- contacts: Array()}}\\
  Attributo che definisce la lista degli utenti presenti nella rubrica dell'utente che ha effettuato l'autenticazione.
   \item{\memberdata{-- group: Array()}}\\
  Attributo che definisce la lista dei gruppi presenti nella rubrica dell'utente che ha effettuato l'autenticazione.

\end{description}

\subsubsection*{Metodi}
\begin{description}

	\item{\method{+ inizialize(): void}}\\
	Metodo per inizializzare  ``AddressBookPanel'' e lo popolarlo con i contatti della rubrica. Il metodo modifica il DOM creando tre div: divSearch, divSort e divList. Quindi sequenzialmente ne crea il contenuto:
		\begin{itemize}
			\item divSearch: in esso si dovrà definire un campo per l'input testuale e un bottone per ricercare nella lista un utente avente avete tra le parole chiave, una con valore uguale a quello inserito nel campo d'input.
			\item divSort: in esso crea delle \inglese{select} per specificare le tipologie di ordinamento attuabili sulla lista degli utenti.
			\item divList: div che viene popolato con i nomi degli utenti presenti nella rubrica dell'utente che l'ha richiamata.
		\end{itemize}

Quindi dopo aver creato questi elementi il metodo procede inserendo nel DOM il ``sotto-albero'' cosi creato.

	\item{\method{+ getAddressBookContacts(): void}}\\
Metodo che recupera i contatti della propria rubrica dal server usando la tecnologia AJAX. Il metodo crea una variabile contenente un istanza \texttt{XMLHttpRequest()}. Quindi con metodo \inglese{POST} inoltra la richiesta alla servlet richiamandola al URL salvato nell'attributo \memberdata{urlServlet}. Quindi elabora i dati ottenuti mediante il metodo \texttt{JSON.parse()} e li salva nell'array \memberdata{contact}.
	
	\item{\method{+ setup(): void}}\\
	Inserisce i contatti estratti dal server all'interno della lista ``AddressBookList'' all'interno di ``AddressBookPanel''.
	
	\item{\method{+ displayContactList(contact: String[]): void}}\\
	Metodo usato per visualizzare la lista dei contatti utente. Il metodo prende il nodo DOM (già esistente) e destinato a contenere la lista dei contatti, popolandolo richiamando il metodo \method{addListItem()}.
	
	\item{\method{-- addListItem(contact: String[]): void}}\\
	Metodo richiamato da \method{dysplayContactList()} per visualizzare i contatti presenti all'array \memberdata{contact} (passato come parametro). Il metodo crea le variabili contenenti i dati del contatto da attribuire al tag di markup \texttt{li}. Tali variabili sono quelle tipiche di un oggetti \classname{JSUserData} (nome, cognome, email, status e immagine).
	
	\item{\method{+ addContact(idContact: int): boolean}}\\
	Metodo per l'aggiunta di un contatto alla rubrica. Il metodo riceve come parametro una stringa che definisce l'id dell'utente da inserire nella propria rubrica. Per assicurarsi di non introdurre ridondanza ed aggiungere un contatto già presente, il metodo esegue due controlli: uno lato client e uno lato server. Per il controllo lato client, si scorre la lista \memberdata{contact} alla ricerca di un id che fa match con idContact. Nel caso già presente il metodo termina ritornando false. Per eseguire il controllo lato server il metodo contatta il server mediante la \inglese{servlet} AddressBookManager. Questa verificherà se l'utente avente id idContact è già presente nella rubrica. Nel caso l'utente non sia presente si occuperà di creare la nuova istanza di AddressBookEntry e la registrerà nel database. In caso contrario non fa niente. La chiamata a servlet ritorna un valore booleano. Tale valore sarà true se l'inserimento ha avuto successo, false altrimenti. Se l'inserimento ha avuto successo il flusso principale prosegue eseguendo l'aggiornamento della rubrica in locale tramite la chiamata a metodo \method{getAddressBookContacts()} seguita da \method{setup()}. Il metodo termina ritornando true se è stato aggiunto l'utente, false altrimenti.

	\item{\method{+ deleteContact(idContact: int): boolean}}\\
Metodo il cui funzionamento è analogo a quello precedentemente definito. Il metodo si occupa di eliminare un contatto conoscendone l'id, passato per parametro d'ingresso. Il flusso principale esegue due controlli per verificare la presenza dell'utente nella rubrica (analogamente a quanto visto nel caso precedente). Dopo tale verifica, se il contatto è realmente presente nella rubrica, allora la \inglese{servlet} AddressBookManager avrà eseguito la cancellazione come conseguenza al match effettuato in fase di verifica. Quindi nel caso il metodo richiama \method{getAddressBookContacts()} seguito da \method{setup()} per rieseguire l'aggiornamento della rubrica. Il metodo ritorna \inglese{true} se effettivamente il contatto era presente ed è stato eliminato, \inglese{false} altrimenti.

	\item{\method{+ addGroup(name: String): boolean}}\\
	Metodo per l'aggiunta di un nuovo gruppo nella rubrica. Il metodo permette l'aggiunta di gruppi con nomi duplicati, ossia nomi di gruppi già presenti nella rubrica. Il flusso principale richiama la \inglese{servlet} AddressBookManager passandogli il nome del gruppo da creare. Quindi il metodo richiama prima \method{getAddressBookContacts()} seguito da \method{setup()} per aggiornare la rubrica in locale. Il metodo ritorna un \inglese{feedback} booleano per dare notifica sull'esito dell'operazione: \inglese{true} se è stato creato il nuovo gruppo, \inglese{false} altrimenti.
	
	\item{\method{+ deleteGroup(idGroup: int): boolean}}\\
	Metodo per l'eliminazione di un nuovo gruppo presente nella rubrica. Il metodo riceve come parametro d'ingresso l'id del gruppo da eliminare. Il flusso principale richiama la \inglese{servlet} AddressBookManager passandogli l'id del gruppo candidato all'eliminazione. Quindi, se la servlet notifica l'effettiva esistenza di un gruppo con tale id, essa si occupa dell'eliminazione e il flusso principale ritorna al metodo \method{deleteGroup} che richiama \method{getAddressBookContacts()} seguito da \method{setup()} per aggiornare la rubrica in locale. Il metodo ritorna un \inglese{feedback} booleano per dare notifica sull'esito dell'operazione: \inglese{true} se è stato creato il nuovo gruppo, \inglese{false} altrimenti.
	
	\item{\method{+ addContactInGroup(idContact: int, name: String): boolean}}\\
	Metodo per l'aggiunta di un contatto in un gruppo ben definito. Il metodo riceve come parametro d'ingresso il nome del gruppo e l'id del contatto da aggiungervi. Il metodo richiama da prima \method{contactExistInGroup}, poi Il flusso principale richiama la \inglese{servlet} AddressBookManager passandogli i parametri d'ingresso. Quindi, se la \inglese{servlet} notifica l'effettiva esistenza di un gruppo con il nome ricevuto, essa si occupa di aggiungervi il contatto e il flusso principale ritorna al metodo \method{addContactInGroup} che richiama \method{getAddressBookContacts()} seguito da  \method{setup()} per aggiornare la rubrica in locale. Il metodo ritorna un \inglese{feedback} booleano per dare notifica sull'esito dell'operazione: \inglese{true} se è stato creato il nuovo gruppo, \inglese{false} altrimenti.	
	
	\item{\method{+ deleteContactInGroup(idContact: int, name: String): boolean}}\\
	Metodo per l'eliminazione di un contatto presente in un gruppo. Il metodo riceve come parametro d'ingresso il nome del gruppo, su cui effettuare la ricerca del contatto da eliminare, e l'id di tale contatto. Il metodo richiama da prima \method{contactExistInGroup}, poi Il flusso principale richiama la \inglese{servlet} AddressBookManager passandogli i parametri d'ingresso. Quindi, se la \inglese{servlet} notifica l'effettiva esistenza di un gruppo con il nome ricevuto che contiene il contatto candidato all'eliminazione, essa si occupa dell'eliminazione e il flusso principale ritorna al metodo \method{deleteContactInGroup} che richiama \method{getAddressBookContacts()} seguito da  \method{setup()} per aggiornare la rubrica in locale. Il metodo ritorna un \inglese{feedback} booleano per dare notifica sull'esito dell'operazione: \inglese{true} se è stato creato il nuovo gruppo, \inglese{false} altrimenti.
	
	\item{\method{+ contactExistInGroup(idContact: int, idGroup: int): boolean}}\\
Metodo che verifica l'esistenza di un contato in un determinato gruppo. Il metodo restituisce un feedback booleano per confermare o meno l'esistenza dell'utente ricercato nel gruppo designato.

\end{description}

\classsection{LoginPanelPresenter}

\subsubsection*{Funzione}
Presenter incaricato di gestire il pannello di login. Tale funzionalità è svolta prendendo in carica i dati inseriti dall'utente (username e password), e passandoli al server per eseguire l'autenticazione. La \inglese{servlet} usata a tale scopo è LoginManager.

Il presenter si occupa anche di fornire delle funzionalità per il recupero della password.

\subsubsection*{Relazioni d'uso}

\subsubsection*{Attributi}
\begin{description}

  \item{\memberdata{-- element: DOM\_node}}\\
  Attributo che definisce il contenuto del nodo DOM inerente alla schermata di login. Nello specifico tale nodo corrisponde ad un \texttt{<div>} con id \texttt{LoginPanel}.
  \item{\memberdata{-- urServlet: String}}\\
  Attributo contenente l'url della servlet incaricata di gestire il login.

\end{description}

\subsubsection*{Metodi}
\begin{description}

	\item{\method{-- testCredentials(data: String): void}}\\
Metodo che testa quanto ricevuto dal server e, in caso di login avvenuto correttamente reindirizza il browser nella pagina finale dopo aver salvato i dati dell'utente. Il metodo inizia salvando, in una variabile avente nome user, il contenuto di data trattato attraverso una chiamata \texttt{JSON.parse(data)}. Quindi se il contenuto di user non è nullo si procede richiamando il \texttt{communicationcenter} e impostando il valore di \texttt{communicationcenter.my} a user. Il metodo termina richiamando  il metodo \method{hide()} e avviando la costruzione della UI mediante una chiamata \method{medietor.buildUI()}.
	
	\item{\method{-- sendAnswer(username: String, answer: String): void}}\\
	Metodo per inviare la risposta alla domanda segreta al server. Il metodo riceve 2 parametri d'ingresso: lo username dell'utente e la risposta (answer) da inviare al server. Come primo passo viene creata un istanza di \texttt{XMLHttpRequest} salvata in una variabile avente nome request. Quindi associo all'evento onclick di request, una funzione avente il compito di inviare la richiesta AJAX al server, e di richiamare in risposta uno dei seguenti metodi:
	\begin{itemize}
		\item \method{correctAnswer()} nel caso la risposta inviata sia corretta;
		\item \method{incorrectAnswer()} se invece la risposta inviata dall'utente è errata.
	\end{itemize}
	
	\item{\method{- correctAnswer(): void}}\\
	Metodo usato per modificare il nodo DOM salvato in \memberdata{element}, per comunicare all'utente che la risposta da lui inserita (per il recupero password) è corretta. Il metodo deve rimuovere il figlio ``passwordretrieval'' da \memberdata{element}. quindi salva in una variabile avente nome message, il contenuto di una chiamata \verb|document.createElement("p")|. Successivamente si procede caricando su message (usando il metodo \texttt{appendChild(var\_figlio)}) il messaggio da visualizzare per notificare all'utente il successo dell'operazione. Il messaggio visualizzato dovrà essere: \\
	
	\verb|Recupero password avvenuto correttamente.|\\
	\verb|Ti è stata inviata un'email contenente i dati richiesti.|\\
	
il messaggio sopracitato è temporaneo e dovrà essere rimosso allo scadere di un timeout di durata 2000 millisecondi (usare la funzione \texttt{window.setTimeout(nome\_funzione))}.
	
	\item{\method{- incorrectAnswer(): void}}\\
	Metodo che In caso di inserimento della risposta non corretta alla domanda segreta, visualizza un messaggio di avvertimento all'utente per 2 secondi quindi lascia il controllo al form di inserimento della risposta alla domanda segreta.
	
	Il metodo deve cerare un elemento (\texttt{document.createElement("p")}) per la visualizzazione del messaggio:\\
	
	\verb|Dati non corretti. Inserire nuovamente la risposta.|\\
	
	Quindi si visualizza il messaggio con una procedura identica a quella usata in \method{correctAnswer()}.
		
	\item{\method{- getSecretQuestion(): void}}\\
	Metodo che recupera la domanda segreta con una richiesta asincrona al server. Il metodo imposta una variabile userID con il valore ritornato da una chiamata \method{getUsername()}. Quindi avvia una richiesta AJAX inizializzando un oggetto \texttt{XMLHttpRequest}. La variabile request contenente tale istanza dovrà associare all'evento \texttt{onreadystatechange} una funzione che si occupa di catturare la stringa ritornata dal server (uso obbligatorio di \texttt{question = this.responseText}). Il metodo termina restituendo  il valore contenuto in question.
	
	\item{\method{+ inizialize(): void}}\\
	\item{\method{+ inizialize(): void}}\\
	\item{\method{+ inizialize(): void}}\\
	

\end{description}

\clearpage

\section{Specifica sotto-architettura clientview}\label{sec:clientviewarchitecture}

\clearpage

\section{Tracciamento della relazione componenti-requisiti}

\end{document}
